<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Stake | Rebel Pool</title>

  <!-- Core styles -->
  <link rel="stylesheet" href="css/style.css">

  <!-- Rebel Pool Branding -->
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="Rebel Pool — Monad Testnet Liquid Staking (stMON/wstMON). 100% yield to stakers. No VC skim.">
</head>
<body>
  <div class="masthead">
    <div class="masthead-title">REBEL POOL</div>
    <div class="masthead-copyright">&copy; 2025 Rebel Pool Cooperative. All Rights Reserved.</div>
    <div class="masthead-datebar"></div>
    <div class="masthead-date">
      <span id="masthead-date"></span>
      <span id="masthead-clock"></span>
    </div>
    <div class="masthead-datebar"></div>
  </div>

  <nav id="topnav" style="display: flex; align-items: center;">
    <a href="index.html">Home</a>
    <a href="stake.html" class="active">Stake</a>
    <a href="withdraw.html">Withdraw</a>
    <a href="wrap.html">Wrap / Unwrap</a>
    <a href="stats.html">Pool Stats</a>
    <a href="truth.html">Code Truth</a>
    <div style="margin-left:auto; display:flex; align-items:center; gap:6px; padding-right: 12px;">
      <label for="network-select" style="font-size:13px;">Network:</label>
      <select id="network-select" style="font-size:14px; padding:2px 6px; margin-left:6px;"></select>
    </div>
  </nav>

  <div id="container">
    <div id="sidebar">
      <a href="faq.html">FAQ</a>
      <a href="validators.html">Validators</a>
      <a href="contact.html">Contact</a>
      <a href="about.html">About</a>
    </div>
    <div id="main">
      <div class="main-card">
            <div class="card-header">
              <div>
                <strong>Stake MON, Earn stMON</strong>
                <div class="muted" style="font-size: .8em;">
                  The only Zero Skim Liquid Stake Pool on Monad!
                </div>
              </div>
            </div>
        <div id="wallet-ui">
          <button id="connect-btn">Connect Wallet</button>
          <div id="wallet-address" style="margin:10px 0 6px 0; display:none;"></div>
          <div style="font-size:0.98em;margin-bottom:10px;">
            <b id="native-sym-label">MON:</b> <span id="balance-mon">–</span><br>
            <b id="aqua-sym-label">stMON:</b> <span id="balance-stmon">–</span>
          </div>
          <hr>
          <div id="stake-ui">
            <label>
              <input type="number" min="0" step="0.01" id="stake-amount" placeholder="Amount to stake (MON)">
            </label>
            <button id="stake-btn" style="margin-left:10px;">Stake Now</button>
            <div id="stake-status" style="font-size:0.96em;margin-top:4px;"></div>
          </div>
          <hr>
          <div style="margin-bottom:10px;">
            <b>Estimated APR:</b>
            <span id="stat-apr">–</span>
            <span id="apr-hint" class="info-icon1" onclick="showAPRInfoModal()">ℹ️</span>
          </div>
          <div id="yield-estimate" style="margin:14px 0 10px 0; font-size:0.97em;">
            <b>Projected <span id="aqua-sym-label2">stMON</span> if you hold:</b><br>
            +1 day: <span id="est-24h">–</span><br>
            +1 week: <span id="est-week">–</span><br>
            +1 month: <span id="est-month">–</span><br>
            +1 year: <span id="est-year">–</span>
          </div>
          <div style="margin-top:10px;">
            <button id="add-token-btn" onclick="addTokenToMetaMask('stMON')">Add stMON to Wallet</button>
          </div>
          <div style="margin-top:10px; font-size:0.9em;">
            <a id="view-stmon-link" href="#" target="_blank" rel="noopener">View stMON on Explorer</a>
          </div>
          <hr>
          <div style="margin-top:16px; text-align:center;">
            <button id="open-automations-btn" class="btn primary">Advanced Automations</button>
          </div>
          <div id="active-bots-summary" style="
              margin-top:12px;
              font-size:0.9em;
              color:#333;
              background:#f9f9f9;
              border:1px solid #ddd;
              border-radius:6px;
              padding:8px 10px;
            "></div>
          
        </div>
        </div>
      </div>
    </div>
  </div>

  <footer>© 1994–2025 Rebel Pool. Best viewed in Mosaic 2.0. Staking involves risk.</footer>

<!-- Automations Modal -->
<div id="automations-modal" class="modal" style="display:none;">
  <div class="modal-content compact" style="max-width:480px;">
    <span id="automations-close" class="modal-close">&times;</span>
    <h3 style="margin:0 0 6px;">Advanced Automations</h3>
    <p class="muted" style="margin:0 0 10px; font-size:0.9em;">
      Configure on-chain triggers for your staking.
    </p>

    <!-- Recommended toggle -->
    <div class="automation-trigger compact">
      <label class="switch">
        <input type="checkbox" id="recommended-toggle">
        <span class="slider"></span>
      </label>
      <div>
        <b>Recommended Automations</b>
        <div class="muted" style="font-size:0.8em;">Automatically set best defaults.</div>
      </div>
    </div>
    <hr class="automation-sep">

    <!-- Automations list -->
    <div id="automations-list">
      <div class="automation-trigger compact">
        <div>
          <strong>Auto-Compound</strong> <span class="info-icon" data-info="info-auto-compound">ℹ️</span>
          <div class="muted small">Re-stake rewards automatically.</div>
        </div>
        <label class="switch"><input type="checkbox" id="ac-toggle"><span class="slider"></span></label>
      </div>
      <hr>
      <div class="automation-trigger compact">
        <div>
          <strong>Scheduled DCA</strong> <span class="info-icon" data-info="info-dca">ℹ️</span>
          <div class="muted small">Deposit MON on a recurring schedule.</div>
        </div>
        <label class="switch"><input type="checkbox" id="dca-toggle"><span class="slider"></span></label>
      </div>
      <hr>
      <div class="automation-trigger compact">
        <div>
          <strong>Validator Switch</strong> <span class="info-icon" data-info="info-validator">ℹ️</span>
          <div class="muted small">Move stake to higher-yield validators.</div>
        </div>
        <label class="switch"><input type="checkbox" id="vs-toggle"><span class="slider"></span></label>
      </div>
      <hr>
      <div class="automation-trigger compact">
        <div>
          <strong>Partial Stop-Loss</strong> <span class="info-icon" data-info="info-stoploss">ℹ️</span>
          <div class="muted small">Redeem part of stake if drawdown hits.</div>
        </div>
        <label class="switch"><input type="checkbox" id="sl-toggle"><span class="slider"></span></label>
      </div>
      <hr>
      <div class="automation-trigger compact">
        <div>
          <strong>Harvest & Convert</strong> <span class="info-icon" data-info="info-harvest">ℹ️</span>
          <div class="muted small">Swap rewards into MON or stablecoin.</div>
        </div>
        <label class="switch"><input type="checkbox" id="hc-toggle"><span class="slider"></span></label>
      </div>
      <hr>
      <div class="automation-trigger compact">
        <div>
          <strong>Yield Rebalance</strong> <span class="info-icon" data-info="info-rebalance">ℹ️</span>
          <div class="muted small">Route deposits to best strategies.</div>
        </div>
        <label class="switch"><input type="checkbox" id="yr-toggle"><span class="slider"></span></label>
      </div>
      <hr>
      <div class="automation-trigger compact">
        <div>
          <strong>Suggestions</strong> <span class="info-icon" data-info="info-suggest">ℹ️</span>
          <div class="muted small">Receive nudges without automation.</div>
        </div>
        <label class="switch"><input type="checkbox" id="sg-toggle"><span class="slider"></span></label>
      </div>
    </div>
<div id="automations-status" class="muted" style="margin-top:12px; font-size:0.9em; text-align:center;">
</div>
    <div style="margin-top:12px; text-align:center;">
      <button id="save-automations-btn" class="btn primary">Activate your Bots</button>
    </div>
  </div>
</div>

<div id="info-modal" class="modal" style="display:none;">
  <div class="modal-content" style="max-width:500px;">
    <span id="info-modal-close" class="modal-close">&times;</span>
    <h3 id="info-modal-title">Info</h3>
    <div id="info-modal-body" style="margin-top:10px; font-size:0.95em; line-height:1.5;">
      Loading…
    </div>
  </div>
</div>

<!-- Transaction Info Modal -->
<div id="txinfo-modal" class="modal" style="display:none;">
  <div class="modal-content" style="max-width:420px; text-align:center;">
    <span id="txinfo-modal-close" class="modal-close">&times;</span>
    <h3 id="txinfo-modal-title">Transaction in Progress</h3>
    <div id="txinfo-modal-body" style="margin-top:10px; font-size:0.95em; line-height:1.5;">
      Please confirm the transaction in your wallet…
    </div>
    <div id="txinfo-modal-spinner" style="margin-top:16px;">
      ⏳
    </div>
  </div>
</div>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="js/chain.js"></script>
  <script src="js/wallet.js"></script>
  <script src="js/rpc-utils.js"></script>
  <script src="js/wallet-picker.js"></script>
  <script src="js/stake.js"></script>
  <script src="js/agent.js"></script>
</body>
</html>
